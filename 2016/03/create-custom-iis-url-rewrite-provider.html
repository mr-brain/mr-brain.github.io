<h2>Create Custom IIS URL Rewrite Provider</h2>
<p>Developing a Custom Rewrite Provider for URL Rewrite Module</p>
<h3>Creating a Visual Studio C# Class Library Project</h3>
<ul>
<li>add references to Microsoft.Web.Iis.Rewrite.dll located in &quot;%ProgramFiles%\Reference Assemblies\Microsoft\IIS&quot;.</li>
</ul>
<p>Rewrite providers must be placed in the .NET Global Assembly Cache (GAC)</p>
<ul>
<li>To sign the assembly, In the Signing tab check &quot;Sign the assembly&quot; check box.</li>
</ul>
<p>In the combo box, select the option &lt;Newâ€¦&gt; to create a new key. In the &quot;Create Strong Name Key&quot; dialog, type DemoKey.snk as the name for the key and uncheck the Protect my key file with a password check box. Click OK.</p>
<p><img src="images/iis-url-rewrite-4.png" alt="sign the assembly" /></p>
<ul>
<li>Select the &quot;Build Events&quot; tab and add the following &quot;Post-build event&quot; command line:</li>
</ul>
<p>CALL &quot;%VS90COMNTOOLS%\vsvars32.bat&quot; &gt; NULL
gacutil.exe /if &quot;$(TargetPath)&quot;</p>
<p>Note: if you use Visual Studio 2010 then replace %VS90COMNTOOLS% with %VS100COMNTOOLS%.</p>
<h3>Implementing the provider interfaces</h3>
<pre><code>public class CdnRewriteProvider : IRewriteProvider, IProviderDescriptor
{
}
</code></pre>
<h3>Registering and configuring the provider</h3>
<ul>
<li>Open IIS Manager and select the URL Rewrite feature</li>
</ul>
<p><img src="create-custom-iis-url-rewrite-provider/iis-url-rewrite-1.png" alt="Step1" /></p>
<p><img src="create-custom-iis-url-rewrite-provider/iis-url-rewrite-2.png" alt="Step2" /></p>
<p><img src="create-custom-iis-url-rewrite-provider/iis-url-rewrite-3.png" alt="Step3" /></p>
<p>This completes the registration and configuration of a rewrite provider. As a result the web.config file for the default web site will contain the following XML code inside of the <rewrite> section:</p>
<pre><code>&lt;system.webServer&gt;
	&lt;rewrite&gt;
		&lt;providers&gt;
			&lt;provider name=&quot;T1.IisUrlRewriteModule&quot; type=&quot;T1.IisUrlRewriteModule.CdnRewriteProvider, T1.IisUrlRewriteModule, Version=1.0.0.0, Culture=neutral, PublicKeyToken=cd92a3df2f0d20b9&quot;&gt;
				&lt;settings&gt;
					&lt;add key=&quot;config&quot; value=&quot;aaa&quot; /&gt;
				&lt;/settings&gt;
			&lt;/provider&gt;
		&lt;/providers&gt;
	&lt;/rewrite&gt;
&lt;/system.webServer&gt;
</code></pre>

